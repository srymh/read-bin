(function(h,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(h=typeof globalThis<"u"?globalThis:h||self,d(h.MyLib={}))})(this,function(h){"use strict";const d={uint8:1,uint16:2,uint32:4,int8:1,int16:2,int32:4,float32:4,float64:8,string:1,boolean:1,"uint8[]":1,"uint16[]":2,"uint32[]":4,"int8[]":1,"int16[]":2,"int32[]":4,"float32[]":4,"float64[]":8,"string[]":1,"boolean[]":1,custom:0};function w(c,g){const{schema:u,offset:l=0,endian:f="big",validate:i}=g,r={},A=[...Object.entries(u)].sort(S);let a=l;for(const[o,U]of A){const{type:k,offset:I=a,byte:p=d[k]||0,count:m=1,endian:y=f}=U,n=T(p,m),s=_(c,I,y);switch(k){case"uint8":r[o]=s.getUint8(0),a+=n;break;case"uint16":r[o]=s.getUint16(0),a+=n;break;case"uint32":r[o]=s.getUint32(0),a+=n;break;case"int8":r[o]=s.getInt8(0),a+=n;break;case"int16":r[o]=s.getInt16(0),a+=n;break;case"int32":r[o]=s.getInt32(0),a+=n;break;case"float32":r[o]=s.getFloat32(0),a+=n;break;case"float64":r[o]=s.getFloat64(0),a+=n;break;case"string":{const e=[];for(let t=0;t<n;t+=1)e.push(s.getUint8(t));r[o]=String.fromCharCode(...e),a+=n;break}case"boolean":r[o]=s.getUint8(0)!==0,a+=n;break;case"uint8[]":{const e=[];for(let t=0;t<n;t+=1)e.push(s.getUint8(t));r[o]=e,a+=n;break}case"uint16[]":{const e=[];for(let t=0;t<n;t+=2)e.push(s.getUint16(t));r[o]=e,a+=n;break}case"uint32[]":{const e=[];for(let t=0;t<n;t+=4)e.push(s.getUint32(t));r[o]=e,a+=n;break}case"int8[]":{const e=[];for(let t=0;t<n;t+=1)e.push(s.getInt8(t));r[o]=e,a+=n;break}case"int16[]":{const e=[];for(let t=0;t<n;t+=2)e.push(s.getInt16(t));r[o]=e,a+=n;break}case"int32[]":{const e=[];for(let t=0;t<n;t+=4)e.push(s.getInt32(t));r[o]=e,a+=n;break}case"float32[]":{const e=[];for(let t=0;t<n;t+=4)e.push(s.getFloat32(t));r[o]=e,a+=n;break}case"float64[]":{const e=[];for(let t=0;t<n;t+=8)e.push(s.getFloat64(t));r[o]=e,a+=n;break}case"string[]":{const e=[];for(let b=0;b<n;b+=1)e.push(s.getUint8(b));if(typeof p=="number"){r[o]=String.fromCharCode(...e),a+=n;break}const t=[];let E=0;for(let b=0;b<Math.min(m,p.length);b++){const F=E+p[b];t.push(String.fromCharCode(...e.slice(E,F))),E=F}r[o]=t,a+=n;break}case"boolean[]":{const e=[];for(let t=0;t<n;t+=1)e.push(s.getUint8(t)!==0);r[o]=e,a+=n;break}case"custom":{const{value:e,length:t=n}=U.parse({reader:s,details:{offset:I,length:n,buffer:c,byte:p,count:m,endian:y,data:r}});r[o]=e,a+=t;break}default:throw new Error(`Unknown type: ${k}`)}}if(i){if(!i(r))throw new Error("Validation error");return{data:r,meta:{offset:l,length:a-l}}}else return{data:r,meta:{offset:l,length:a-l}}}function S(c,g){const u=i=>i==null?Number.MAX_SAFE_INTEGER-1:i==="last"?Number.MAX_SAFE_INTEGER:i==="first"?-Number.MAX_SAFE_INTEGER:i,l=u(c[1].order),f=u(g[1].order);return l-f}function T(c,g){if(Array.isArray(c)){let u=0;for(let l=0;l<Math.min(g,c.length);l++)u+=c[l];return u}else return c*g}function _(c,g,u){const l=new DataView(c,g),f=u==="little";return{getUint8:i=>l.getUint8(i),getUint16:i=>l.getUint16(i,f),getUint32:i=>l.getUint32(i,f),getInt8:i=>l.getInt8(i),getInt16:i=>l.getInt16(i,f),getInt32:i=>l.getInt32(i,f),getFloat32:i=>l.getFloat32(i,f),getFloat64:i=>l.getFloat64(i,f)}}h.readBin=w,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
